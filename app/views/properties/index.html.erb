<body>
  <div class="catalog-header">
    <% if account_signed_in? %>
      <div class="admin-actions">
        <%= link_to "Nueva Propiedad", new_property_path, class: "boton_login btn-primary" %>
        <%= link_to "Cerrar Sesión", destroy_account_session_path, 
            data: { turbo_method: :delete }, class: "boton_login btn-secondary" %>
      </div>
    <% end %>
    
    <h1 class="catalog-title">Propiedades disponibles</h1>
  </div>

  <div class="properties-container">
    <% @properties.each do |property| %>
      <article class="property-card">
        <div class="index_photo">
          <% if property.photos.attached? %>
            <%= image_tag property.photos.first, 
                alt: "Propiedad en #{property.direccion}, #{property.colonia}", 
                class: "foto_casa",
                loading: "lazy" %>
          <% else %>
            <div class="photo-placeholder">
              <i class="fa-solid fa-house"></i>
              <p>Sin foto</p>
            </div>
          <% end %>
        </div>

        <div class="caption">
          <div class="property-info">
            <p class="property-address">
              <i class="fa-solid fa-location-dot"></i>
              <strong>Dirección:</strong> <%= property.direccion %>
            </p>
            <p class="property-neighborhood">
              <i class="fa-solid fa-map-pin"></i>
              <strong>Colonia:</strong> <%= property.colonia %>
            </p>
            <p class="property-price">
              <%= number_to_currency(property.precio, unit: "$", separator: ".", delimiter: ",") %>
            </p>
          </div>

          <div class="botones_index">
            <%= link_to "Ver propiedad", property_path(property), class: "boton btn-view" %>
            <% whatsapp_msg = "Hola, me interesa la propiedad en #{property.direccion}" %>
            <a href="https://wa.me/524777309939?text=<%= URI.encode_www_form_component(whatsapp_msg) %>" 
              target="_blank" 
              rel="noopener noreferrer"
              class="boton btn-whatsapp">
              <i class="fa-brands fa-whatsapp"></i> Reservar
            </a>
          </div>
        </div>
      </article>
    <% end %>
  </div>

  <% if @properties.empty? %>
    <div class="empty-state">
      <i class="fa-solid fa-house-circle-xmark"></i>
      <h2>No hay propiedades disponibles</h2>
      <p>Vuelve pronto para ver nuevas opciones</p>
    </div>
  <% end %>
</body>